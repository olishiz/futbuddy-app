{"version":3,"file":"src_app_pages_secure_games_games_module_ts.js","mappings":"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","sources":["./src/app/pages/secure/games/games.page.html","./src/app/pages/secure/games/games-routing.module.ts","./src/app/pages/secure/games/games.module.ts","./src/app/pages/secure/games/games.page.ts"],"sourcesContent":["export default \"<ion-header collapse=\\\"fade\\\" [translucent]=\\\"true\\\">\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button text=\\\"Home\\\" defaultHref=\\\"/home\\\">\\r\\n            </ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <ion-title>\\r\\n            Game Session Detail\\r\\n        </ion-title>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n\\r\\n    <ion-list-header class=\\\"ion-text-center\\\">\\r\\n        <ion-label color=\\\"white\\\">{{ (game$ | async)?.name }}</ion-label>\\r\\n    </ion-list-header>\\r\\n\\r\\n    <ion-img src=\\\"{{ (game$ | async)?.arenaPhotoUrl }}\\\" alt=\\\"Futsal court\\\"></ion-img>\\r\\n\\r\\n    <ion-grid>\\r\\n        <ion-row>\\r\\n            <ion-col>\\r\\n                <ion-chip color=\\\"tertiary\\\">Format: {{ (game$ | async)?.formatType }}</ion-chip>\\r\\n            </ion-col>\\r\\n            <ion-col>\\r\\n                <ion-chip color=\\\"tertiary\\\">Price: {{ (game$ | async)?.price }} </ion-chip>\\r\\n            </ion-col>\\r\\n            <ion-col>\\r\\n                <ion-chip color=\\\"tertiary\\\">Floor: {{ (game$ | async)?.floorType }}</ion-chip>\\r\\n            </ion-col>\\r\\n        </ion-row>\\r\\n    </ion-grid>\\r\\n\\r\\n    <div class=\\\"ion-text-center\\\">\\r\\n        <ion-text color=\\\"light\\\" style=\\\"margin-top: 10px\\\">\\r\\n            <ion-icon name=\\\"location\\\"></ion-icon>\\r\\n            Location: {{ (game$ | async)?.location }}\\r\\n            <br>\\r\\n        </ion-text>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"ion-text-center\\\">\\r\\n        <ion-text color=\\\"light\\\" style=\\\"margin-top: 10px\\\">\\r\\n            <ion-icon name=\\\"calendar-outline\\\"></ion-icon>\\r\\n            Date: {{ (game$ | async)?.date }}\\r\\n            <br>\\r\\n        </ion-text>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"ion-text-center\\\">\\r\\n        <ion-text color=\\\"light\\\" style=\\\"margin-top: 10px\\\">\\r\\n            <ion-icon name=\\\"time-outline\\\"></ion-icon>\\r\\n            Time: {{ (game$ | async)?.time }}\\r\\n            <br>\\r\\n        </ion-text>\\r\\n    </div>\\r\\n\\r\\n    <hr style=\\\"background: grey\\\">\\r\\n\\r\\n    <div class=\\\"ion-text-center\\\">\\r\\n\\r\\n        <!-- Spots left -->\\r\\n        <ion-chip>\\r\\n            <ion-icon name=\\\"people\\\"></ion-icon>\\r\\n            <ion-label>{{ calculateSpotsLeft() }} spots left</ion-label>\\r\\n        </ion-chip>\\r\\n\\r\\n        <br>\\r\\n        Lineup\\r\\n        <br>\\r\\n\\r\\n        Total players signed up: {{ (playerList$ | async)?.length }}\\r\\n\\r\\n        <ion-grid>\\r\\n            <ion-row>\\r\\n                <ion-col size=\\\"6\\\" *ngFor=\\\"let player of playerList$ | async; let i = index\\\">\\r\\n                    <ion-item>\\r\\n                        <ion-label>{{ i + 1 }}. {{ player.playerName }}</ion-label>\\r\\n                    </ion-item>\\r\\n                </ion-col>\\r\\n            </ion-row>\\r\\n        </ion-grid>\\r\\n\\r\\n\\r\\n    </div>\\r\\n\\r\\n    <hr style=\\\"background: grey\\\">\\r\\n\\r\\n    <div class=\\\"ion-text-center\\\">\\r\\n\\r\\n        <ion-button *ngIf=\\\"calculateSpotsLeft() != 0 && !is_modal_open\\\" (click)=\\\"openCard()\\\">Book Slot</ion-button>\\r\\n\\r\\n        <ion-button *ngIf=\\\"calculateSpotsLeft() != 0 && is_modal_open\\\" (click)=\\\"openCard()\\\" [disabled]=\\\"true\\\">\\r\\n            <ion-spinner></ion-spinner>\\r\\n            Book Slot\\r\\n        </ion-button>\\r\\n\\r\\n        <ion-button *ngIf=\\\"calculateSpotsLeft() == 0\\\" [disabled]=\\\"true\\\">Slots Fully Booked</ion-button>\\r\\n    </div>\\r\\n\\r\\n    <br> <br>\\r\\n\\r\\n    <ion-accordion-group>\\r\\n        <ion-accordion value=\\\"first\\\">\\r\\n            <ion-item slot=\\\"header\\\" color=\\\"dark\\\">\\r\\n                <ion-label class=\\\"ion-text-center\\\">Description</ion-label>\\r\\n            </ion-item>\\r\\n            <div class=\\\"ion-padding ion-text-center\\\" slot=\\\"content\\\">\\r\\n\\r\\n                üí¶ Bring your bottle of water <br>\\r\\n\\r\\n                üëï Bibs will be provided <br>\\r\\n\\r\\n                ‚è±Ô∏è Please arrive 15 minutes earlier before the game for briefing and team assignment. <br>\\r\\n\\r\\n                <br> *GAMEPLAY DETAILS* <br>\\r\\n\\r\\n                ü•Ö {{ (game$ | async)?.formatType }} - no subs <br>\\r\\n\\r\\n                ‚ôªÔ∏è Goalkeeper changes, if required <br>\\r\\n\\r\\n                <br> *VENUE DETAILS* <br>\\r\\n\\r\\n                üëå Good quality {{ (game$ | async)?.floorType }} <br>\\r\\n\\r\\n                üöó Ample Parking <br>\\r\\n\\r\\n                ‚úÖ Free shower and dressing rooms <br>\\r\\n            </div>\\r\\n        </ion-accordion>\\r\\n    </ion-accordion-group>\\r\\n\\r\\n</ion-content>\\r\\n\";","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\n\r\nimport { GamesPage } from './games.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: GamesPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class GamesPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { GamesPageRoutingModule } from './games-routing.module';\r\n\r\nimport { GamesPage } from './games.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    GamesPageRoutingModule\r\n  ],\r\n  declarations: [GamesPage]\r\n})\r\nexport class GamesPageModule {}\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport { IGame } from \"../../../models/game.model\";\r\nimport { DataService } from \"../../../services/data/data.service\";\r\nimport { Observable, Subscription } from \"rxjs\";\r\nimport { AngularFirestore } from \"@angular/fire/compat/firestore\";\r\nimport { Auth, user } from \"@angular/fire/auth\";\r\nimport firebase from \"firebase/compat\";\r\nimport { IonRouterOutlet, ModalController } from \"@ionic/angular\";\r\nimport { PaymentPage } from \"../payment/payment.page\";\r\nimport User = firebase.User;\r\n\r\n@Component({\r\n    selector: 'app-games',\r\n    templateUrl: './games.page.html',\r\n    styleUrls: ['./games.page.scss'],\r\n})\r\nexport class GamesPage implements OnInit, OnDestroy {\r\n\r\n    user$ = user(this.auth);\r\n    userSubscription: Subscription;\r\n\r\n    id: string | null = null;\r\n    game$: Observable<IGame>;\r\n    username: string\r\n\r\n    game: any;\r\n\r\n    playerList$: Observable<any[]>;\r\n    playerList: any\r\n\r\n    is_modal_open: boolean = false\r\n\r\n    constructor(\r\n        private route: ActivatedRoute,\r\n        private dataService: DataService,\r\n        private firestore: AngularFirestore,\r\n        private auth: Auth,\r\n        private modalController: ModalController,\r\n        private routerOutlet: IonRouterOutlet\r\n    ) {\r\n\r\n        // Retrieve username from Firebase Auth displayName field\r\n        this.userSubscription = this.user$.subscribe((aUser: User | null) => {\r\n            this.username = aUser.displayName\r\n        })\r\n\r\n    }\r\n\r\n    async ngOnInit() {\r\n\r\n        // Retrieve params id from url\r\n        this.route.params.subscribe(params => {\r\n            this.id = params['id'];\r\n            console.log('this.id', this.id);\r\n        });\r\n\r\n        this.game$ = this.dataService.getGameById(this.id);\r\n        this.playerList$ = this.getPlayerList(this.id);\r\n\r\n        // Convert the Observable to a Promise and log the result\r\n        this.playerList$.toPromise().then(playerList => {\r\n            console.log('Player List:', playerList);\r\n        });\r\n\r\n        // Subscribe and store to variable of player List\r\n        this.playerList$.subscribe(playerList => {\r\n            this.playerList = playerList\r\n            console.log('converted', this.playerList)\r\n        })\r\n\r\n        // Fetch game details\r\n        this.dataService.getGameById(this.id).subscribe(game => {\r\n            this.game = game;\r\n            console.log('the GAME', this.game)\r\n        });\r\n\r\n    }\r\n\r\n    getPlayerList(gameId: string): Observable<any[]> {\r\n        const gameRef = this.firestore.collection('games').doc(gameId);\r\n        const playerListRef = gameRef.collection('playerList');\r\n        return playerListRef.valueChanges(); // Returns an Observable of player data\r\n    }\r\n\r\n    calculateSpotsLeft() {\r\n        if (this.game && this.game.numOfPlayers) {\r\n            const spotsLeft = this.game.numOfPlayers - (this.playerList)?.length;\r\n            return spotsLeft >= 0 ? spotsLeft : 0;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.userSubscription.unsubscribe();\r\n    }\r\n\r\n    async openCard() {\r\n\r\n        this.is_modal_open = true\r\n\r\n        const spotsLeft = this.calculateSpotsLeft()\r\n\r\n        // Open filter modal\r\n        const modal = await this.modalController.create({\r\n            component: PaymentPage,\r\n            swipeToClose: true,\r\n            presentingElement: this.routerOutlet.nativeEl,\r\n            componentProps: {\r\n                game: this.game, // Pass your 'game' object here\r\n                spotsLeft: spotsLeft\r\n            },\r\n        });\r\n\r\n        modal.onDidDismiss().then(() => {\r\n            // Handle the modal dismissal event\r\n            this.is_modal_open = false;\r\n        });\r\n\r\n        return await modal.present();\r\n    }\r\n\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}