{"version":3,"file":"src_app_pages_secure_home_home_module_ts.js","mappings":"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","sources":["./src/app/pages/secure/home/home.page.html","./src/app/pages/secure/home/home-routing.module.ts","./src/app/pages/secure/home/home.module.ts","./src/app/pages/secure/home/home.page.ts"],"sourcesContent":["export default \"<ion-header collapse=\\\"fade\\\" [translucent]=\\\"true\\\">\\r\\n    <ion-toolbar>\\r\\n        <ion-title>\\r\\n            Home\\r\\n        </ion-title>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content [fullscreen]=\\\"true\\\">\\r\\n    <ion-header collapse=\\\"condense\\\">\\r\\n        <ion-toolbar>\\r\\n            <ion-title size=\\\"large\\\">Hello, {{ (user$ | async)?.displayName }}</ion-title>\\r\\n        </ion-toolbar>\\r\\n    </ion-header>\\r\\n\\r\\n    <div class=\\\"ion-padding\\\">\\r\\n\\r\\n        <ion-list-header>\\r\\n            <ion-label color=\\\"white\\\">Upcoming Games</ion-label>\\r\\n        </ion-list-header>\\r\\n\\r\\n        <ion-list-header>\\r\\n            <ion-label color=\\\"white\\\"><p style=\\\"color: white; font-weight: 500;\\\">Here's some suggested games for you:</p></ion-label>\\r\\n        </ion-list-header>\\r\\n\\r\\n        <!-- Skeletons -->\\r\\n        <!--        <ion-list class=\\\"item-card-list animate__animated animate__fadeIn\\\" *ngIf=\\\"!content_loaded\\\">-->\\r\\n        <!--            <ion-item lines=\\\"none\\\" *ngFor=\\\"let i of [].constructor(1);\\\">-->\\r\\n        <!--                <ion-avatar slot=\\\"start\\\">-->\\r\\n        <!--                    <ion-skeleton-text animated></ion-skeleton-text>-->\\r\\n        <!--                </ion-avatar>-->\\r\\n        <!--                <ion-label>-->\\r\\n        <!--                    <h3>-->\\r\\n        <!--                        <ion-skeleton-text animated style=\\\"width: 50%\\\"></ion-skeleton-text>-->\\r\\n        <!--                    </h3>-->\\r\\n        <!--                    <p>-->\\r\\n        <!--                        <ion-skeleton-text animated style=\\\"width: 30%\\\"></ion-skeleton-text>-->\\r\\n        <!--                    </p>-->\\r\\n        <!--                </ion-label>-->\\r\\n        <!--            </ion-item>-->\\r\\n        <!--        </ion-list>-->\\r\\n\\r\\n        <!--   Real items here   -->\\r\\n        <!--        <ion-list class=\\\"item-card-list animate__animated animate__fadeIn\\\" *ngIf=\\\"content_loaded\\\" lines=\\\"none\\\">-->\\r\\n        <!--            <ion-item button detail>-->\\r\\n        <!--                <ion-avatar slot=\\\"start\\\" class=\\\"ion-avatar-default-icon\\\">-->\\r\\n        <!--                    <ion-icon name=\\\"wallet\\\"></ion-icon>-->\\r\\n        <!--                </ion-avatar>-->\\r\\n        <!--                <ion-label>-->\\r\\n        <!--                    <h3>$71,648.13</h3>-->\\r\\n        <!--                    <p>Bank of America</p>-->\\r\\n        <!--                </ion-label>-->\\r\\n        <!--            </ion-item>-->\\r\\n        <!--        </ion-list>-->\\r\\n\\r\\n        <!--        <hr>-->\\r\\n\\r\\n        <ion-card *ngFor=\\\"let game of activeGames\\\">\\r\\n            <img alt=\\\"Silhouette of mountains\\\" src=\\\"{{ game.arenaPhotoUrl }}\\\"/>\\r\\n            <ion-card-header style=\\\"padding-bottom: 0\\\">\\r\\n                <ion-card-title>{{ game.name }}</ion-card-title>\\r\\n                <ion-card-subtitle>\\r\\n                    {{ game.date }}\\r\\n                    <br>\\r\\n                    {{ game.time }}\\r\\n                </ion-card-subtitle>\\r\\n            </ion-card-header>\\r\\n            <ion-card-content>\\r\\n                <ion-text color=\\\"light\\\">\\r\\n                    <ion-chip>\\r\\n                        <ion-icon name=\\\"people\\\"></ion-icon>\\r\\n                        <ion-label>{{ game.spotsLeft }} spots left</ion-label>\\r\\n                    </ion-chip>\\r\\n                    <br>\\r\\n                </ion-text>\\r\\n\\r\\n                <ion-text color=\\\"light\\\">\\r\\n                    <ion-icon name=\\\"cash-outline\\\"></ion-icon>\\r\\n                    Price: {{ game.price }}\\r\\n                    <br>\\r\\n                </ion-text>\\r\\n\\r\\n                <ion-text color=\\\"light\\\">\\r\\n                    <ion-icon name=\\\"location\\\"></ion-icon>\\r\\n                    Location: {{ game.location }}\\r\\n                    <br>\\r\\n                </ion-text>\\r\\n\\r\\n                <br>\\r\\n\\r\\n                <ion-button *ngIf=\\\"game.spotsLeft != 0\\\" (click)=\\\"goToGamePage(game)\\\">Book Slot</ion-button>\\r\\n                <ion-button *ngIf=\\\"game.spotsLeft == 0\\\" [disabled]=\\\"true\\\">Slots Fully Booked</ion-button>\\r\\n\\r\\n            </ion-card-content>\\r\\n        </ion-card>\\r\\n\\r\\n\\r\\n        <!--        <ion-list-header>-->\\r\\n        <!--            <ion-label color=\\\"white\\\">Recent transactions</ion-label>-->\\r\\n        <!--            <ion-button *ngIf=\\\"content_loaded\\\" routerLink=\\\"/payments\\\">See All-->\\r\\n        <!--                <ion-icon slot=\\\"end\\\" name=\\\"arrow-forward\\\"></ion-icon>-->\\r\\n        <!--            </ion-button>-->\\r\\n        <!--        </ion-list-header>-->\\r\\n\\r\\n        <!--        &lt;!&ndash; Skeletons &ndash;&gt;-->\\r\\n        <!--        <ion-list class=\\\"list-custom animate__animated animate__fadeIn\\\" lines=\\\"full\\\" *ngIf=\\\"!content_loaded\\\">-->\\r\\n        <!--            <ion-item *ngFor=\\\"let i of [].constructor(3);\\\">-->\\r\\n        <!--                <ion-label>-->\\r\\n        <!--                    <h3>-->\\r\\n        <!--                        <ion-skeleton-text animated style=\\\"width: 50%\\\"></ion-skeleton-text>-->\\r\\n        <!--                    </h3>-->\\r\\n        <!--                    <p>-->\\r\\n        <!--                        <ion-skeleton-text animated style=\\\"width: 70%\\\"></ion-skeleton-text>-->\\r\\n        <!--                    </p>-->\\r\\n        <!--                </ion-label>-->\\r\\n        <!--                <ion-skeleton-text slot=\\\"end\\\" animated style=\\\"width: 10%\\\"></ion-skeleton-text>-->\\r\\n        <!--            </ion-item>-->\\r\\n        <!--        </ion-list>-->\\r\\n\\r\\n        <!--        <ion-list class=\\\"list-custom animate__animated animate__fadeIn\\\" lines=\\\"full\\\" *ngIf=\\\"content_loaded\\\">-->\\r\\n        <!--            <ion-item button detail=\\\"false\\\">-->\\r\\n        <!--                <ion-label>-->\\r\\n        <!--                    <h3>Coffee</h3>-->\\r\\n        <!--                    <p>Starbucks &middot; 04.01.2022</p>-->\\r\\n        <!--                </ion-label>-->\\r\\n        <!--                <ion-badge color=\\\"danger\\\" mode=\\\"ios\\\" slot=\\\"end\\\">- $8.60</ion-badge>-->\\r\\n        <!--            </ion-item>-->\\r\\n        <!--            <ion-item button detail=\\\"false\\\">-->\\r\\n        <!--                <ion-label>-->\\r\\n        <!--                    <h3>Salary</h3>-->\\r\\n        <!--                    <p>Apple Inc. &middot; 03.01.2022</p>-->\\r\\n        <!--                </ion-label>-->\\r\\n        <!--                <ion-badge color=\\\"medium\\\" mode=\\\"ios\\\" slot=\\\"end\\\">$8412.48</ion-badge>-->\\r\\n        <!--            </ion-item>-->\\r\\n        <!--            <ion-item button detail=\\\"false\\\">-->\\r\\n        <!--                <ion-label>-->\\r\\n        <!--                    <h3>Rent</h3>-->\\r\\n        <!--                    <p>Housing Inc. &middot; 01.01.2022</p>-->\\r\\n        <!--                </ion-label>-->\\r\\n        <!--                <ion-badge color=\\\"danger\\\" mode=\\\"ios\\\" slot=\\\"end\\\">- $1400.00</ion-badge>-->\\r\\n        <!--            </ion-item>-->\\r\\n        <!--        </ion-list>-->\\r\\n\\r\\n    </div>\\r\\n\\r\\n</ion-content>\\r\\n\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { HomePage } from './home.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HomePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class HomePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { HomePageRoutingModule } from './home-routing.module';\r\n\r\nimport { HomePage } from './home.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    HomePageRoutingModule\r\n  ],\r\n  declarations: [HomePage]\r\n})\r\nexport class HomePageModule {}\r\n","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { DataService } from '../../../services/data/data.service';\r\nimport { IGame } from '../../../models/game.model';\r\nimport { AuthService } from '../../../services/auth/auth.service';\r\nimport { Router } from '@angular/router';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\r\nimport { Auth, user } from \"@angular/fire/auth\";\r\nimport firebase from \"firebase/compat\";\r\nimport User = firebase.User;\r\n\r\n@Component({\r\n    selector: 'app-home',\r\n    templateUrl: './home.page.html',\r\n    styleUrls: ['./home.page.scss'],\r\n})\r\nexport class HomePage implements OnInit, OnDestroy {\r\n\r\n    user$ = user(this.auth);\r\n    userSubscription: Subscription;\r\n\r\n    games: IGame[] = [];\r\n    activeGames: IGame[] = [];\r\n\r\n    contentLoaded = false;\r\n\r\n    playerList: any;\r\n    playerList$: Observable<any[]>;\r\n\r\n    username: string;\r\n\r\n    private spotsLeft: number;\r\n\r\n    constructor(\r\n        private dataService: DataService,\r\n        private authService: AuthService,\r\n        private router: Router,\r\n        private firestore: AngularFirestore,\r\n        private auth: Auth,\r\n    ) {\r\n\r\n        this.userSubscription = this.user$.subscribe((aUser: User | null) => {\r\n            console.log('the aUser', aUser);\r\n            this.username = aUser.displayName\r\n        })\r\n\r\n    }\r\n\r\n    ngOnInit() {\r\n\r\n        this.dataService.getGames().subscribe((res: IGame[]) => {\r\n            this.games = res;\r\n            this.activeGames = this.games.filter(game => game.status === 'ACTIVE');\r\n\r\n            // Calculate and set spotsLeft for each game\r\n            this.activeGames.forEach(game => {\r\n                this.calculateSpotsLeft(game);\r\n            });\r\n\r\n            console.log('the games boy', this.games);\r\n            console.log('the active games boy', this.activeGames);\r\n        });\r\n\r\n        // Fake timeout\r\n        setTimeout(() => {\r\n            this.contentLoaded = true;\r\n        }, 2000);\r\n    }\r\n\r\n    async goToGamePage(game: IGame) {\r\n        await this.router.navigateByUrl(`/games/${game.id}`);\r\n    }\r\n\r\n    calculateSpotsLeft(game: any) {\r\n\r\n        this.getPlayerList(game.id).subscribe(playerList => {\r\n            const spotsLeft = game.numOfPlayers - playerList.length;\r\n            game.spotsLeft = spotsLeft >= 0 ? spotsLeft : 0;\r\n            console.log('Spots left for', game.name, ':', game.spotsLeft);\r\n        });\r\n\r\n    }\r\n\r\n    getPlayerList(gameId: string): Observable<any[]> {\r\n        const gameRef = this.firestore.collection('games').doc(gameId);\r\n        const playerListRef = gameRef.collection('playerList');\r\n        return playerListRef.valueChanges(); // Returns an Observable of player data\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.userSubscription.unsubscribe();\r\n    }\r\n\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}